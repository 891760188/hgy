<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<script type="text/javascript" src="../../common/AppBooter.js"></script>
		<script src="../../public/commTool/AppShare.js"></script>
		<script src="data.js"></script>
		<script src="share.js"></script>
	</head>
	<style>
		.edit_wrap {
			padding: 10px;
			height: 100px;
			border: 0;
			border-top: 1px solid #eee;
			margin-bottom: -6px;
		}
		
		.shareImg {
			height: 85px;
			width: 85px;
			border: 3px solid #F5F5F5;
		}
		
		.ys-accordion .mui-icon {
			position: initial;
			width: initial;
			float: right;
			margin-right: 0!important;
		}
		
		.icon-line-136 {
			color: #ddd;
		}
		
		.icon-line-135 {
			color: #4896cd;
		}
		
		.icon-line-un137 {
			color: #ddd;
		}
		
		.icon-line-137 {
			color: #4896cd;
		}
		
		.s-top {
			width: 100%;
			height: 100px;
			background-color: #fff;
		}
		
		.s-bottom {
			width: 100%;
			height: 40px;
			background-color: #fff;
		}
		
		.mui-table-view-cell:last-child:after {
			height: 1px;
		}
		
		.sb-right {
			height: 40px;
		}
		
		.icon-line-25:before {
			margin-right: 10px;
		}
		
		body {
			background-color: #F5F5F5;
		}
		
		.mui-table-view-cell.mui-collapse .aaa {
			padding: 0 15px;
		}
		
		.linkDiv {
			background-color: #F5F5F5;
			border-radius: 3px;
			height: 46px;
			position: relative;
			top: 40px
		}
		
		.linkDiv>img {
			float: left;
			height: 34px;
			margin-top: 6px;
			margin-left: 6px;
			border-radius: 3px;
		}
		
		.linkDiv>p {
			font-size: 12px;
			line-height: 34px;
			width: calc(100% - 40px);
			height: 34px;
			float: left;
			padding: 5px
		}
	</style>

	<body>
		<header class="mui-bar mui-bar-nav">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
			<button class="mui-button mui-btn-blue mui-btn-link  mui-pull-right share" style="color: #666;" id="publish">发布</button>
			<h1 class="mui-title" id="muiTitleId">分享</h1>
		</header>
		<div class="mui-content">
			<div id="textDivId" style="width:100%;background: white;">
				<textarea class="edit_wrap" placeholder="你想说的..." id="contentId"></textarea>
			</div>
			<div style="width:100%;height:140px;background-color: #f9f9f9;">
				<div id="smallTitle" class="s-top mui-table-view-cell" style="background-color: #FFF;padding: 5px 10px;">
					<!--<div class="linkDiv">
						<img src="comShare.png"/>
						<p >商机分享</p>
					</div>-->
					<div><img src="11.jpg" class="shareImg" /></div>
				</div>
				<div class="s-bottom">
					<ul class="mui-table-view">
						<li class="mui-table-view-cell">
							<a class="mui-navigate-right sb-right icon-line-25" onclick="setLocate()">所在位置</a>
						</li>
					</ul>
				</div>
			</div>
			<div style="width:100%;height:10px;background-color:#F5F5F5 ;">
			</div>
			<ul class="mui-table-view" style="padding-left:0px;">
				<li class="mui-table-view-cell" id="gkliId">公开<span class="mui-icon " id="gk" style="float: right;margin-right: 0px;"></span></li>
				<li class="mui-table-view-cell" id="smliId">私密<span class="mui-icon " id="sm" style="float: right;margin-right: 0px;"></span></li>
				<li class="mui-table-view-cell mui-collapse">
					<a class="mui-navigate-right" href="#">部分可见</a>
					<div class="mui-collapse-content aaa">
						<div id="colAcd" class="ys-accordion">
						</div>
					</div>
				</li>
				<li class="mui-table-view-cell mui-collapse">
					<a class="mui-navigate-right" href="#">不给谁看</a>
					<div class="mui-collapse-content  aaa">
						<div id="colAcd2" class="ys-accordion">
						</div>
					</div>
				</li>
			</ul>
		</div>

		</div>
		<script>
			YSUI.Accordion("colAcd");
			YSUI.Accordion("colAcd2");
			getOrg();
			getOrg2();
			/**
			 * 选择机构子节点
			 */
			mui('.ys-accNode').on('tap', '.ys-anContent', function() {
					var span = this.querySelector('span');
					choose(span.getAttribute('data-fn'), span)
				})
				/**
				 * 选择机构 并变换子节点
				 */
			mui('.ys-accNode').on('tap', '.orgSelect', function() {
				chooseOrg(this);
				//使所有子节点都选中
				var list = this.parentElement.nextSibling.querySelectorAll('.orgContent');
				for(var i = 0; i < list.length; i++) {
					changeChild(this, list[i]);
				}
				return false;
			});
			//分享按钮
			document.getElementById('publish').addEventListener('tap', function() {
				sendShare();
				//				var pageId = plus.webview.getWebviewById('find.html');
				//				mui.fire(pageId, '_REFRESH');
				//				mui.toast('分享成功！');
				//				mui.back();
			});
			//点击公共取消其他
			document.getElementById('gkliId').addEventListener('tap', function() {
				var obj = document.getElementById("gk");
				if(obj.classList.contains(_rck)) {
					authorityType = "1";
					obj.classList.add(_ruck);
					obj.classList.remove(_rck);

				} else {
					authorityType = "2";
					obj.classList.remove(_ruck);
					obj.classList.add(_rck);
					document.getElementById('sm').classList.add(_ruck);
					document.getElementById('sm').classList.remove(_rck);
					//变换 部分可见 和不给谁看
					var list = document.getElementById('colAcd').querySelectorAll('.orgSelect');
					for(var j = 0; j < list.length; j++) {
						//先让其选中，再让其消失
						list[j].classList.add(_ck);
						list[j].classList.remove(_uck);
						mui.trigger(list[j], 'tap');
					}
				}
			});
			//点击私密 取消其他
			document.getElementById('smliId').addEventListener('tap', function() {
				var obj = document.getElementById("sm");
				if(obj.classList.contains(_rck)) {
					authorityType = "2";
					obj.classList.add(_ruck);
					obj.classList.remove(_rck);
				} else {
					authorityType = "1";
					obj.classList.remove(_ruck);
					obj.classList.add(_rck);
					document.getElementById('gk').classList.add(_ruck);
					document.getElementById('gk').classList.remove(_rck);
					var list = document.getElementById('colAcd').querySelectorAll('.orgSelect');
					for(var j = 0; j < list.length; j++) {
						//先让其选中，再让其消失
						list[j].classList.add(_ck);
						list[j].classList.remove(_uck);
						mui.trigger(list[j], 'tap');
					}
				}
			})
				/**
			 * 地点设置
			 */
			
			function setLocate(){
				currentId=plus.webview.currentWebview().id;
				var url = "maps.html?currentId="+currentId;
				_App.util.goPage(url, {
					pageId: 'map_id',
					refresh: true
				});
			}
		</script>
	</body>

</html>