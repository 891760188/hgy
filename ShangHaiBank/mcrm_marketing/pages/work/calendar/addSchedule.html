<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>新建日程</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<script type="text/javascript" src="../../common/AppBooter.js" ></script>
		<script src="../../../../resource/mui/js/mui.picker.min.js"></script>
		<script type="text/javascript" src="addSchedule.js" ></script>
		<link rel="stylesheet" type="text/css" href="../../../../resource/mui/css/mui.picker.min.css" />
	</head>
	<style type="text/css">
		.mui-table-btn-flag{}
		.mytime{}
		.borderCss{
			border-color:"white";
			border:"none";
			border-style:"none";
			border: 0px solid yellow
		}
		#firstUl .mui-table-view-cell.mui-active{background:none;}
		#firstUl .mui-table-view-cell>a.mui-active{background:none;}
	</style>
	<body>
		
		<header class="mui-bar mui-bar-nav">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
		    <h1 class="mui-title" id="muiTitleId">新建日程</h1>
		    <a id="senLogId" class=".mui-action-back mui-btn mui-btn-blue mui-btn-link mui-pull-right" style="color: #666;">完成</a>
		</header>
		<div class="mui-content dark-bg">
			<div class="mui-scroll-wrapper mui-nofootscroll">
				<div class="mui-scroll">
				 <form id="addShceduleForm" action="" method="get">
				 	
					<ul class="mui-table-view mui-table-view-group" id="firstUl">
						<li class="mui-table-view-cell" style="height:5em;">
                           	<textarea id="schTitle"  type="text" class="mui-input-clear borderCss" placeholder="日程标题"></textarea>

						</li>
					</ul>
					<ul class="mui-table-view mui-table-view-group">
						<li class="mui-table-view-cell">
							<a class="mui-navigate-right mytime" data-options='{}'>
								<span class="mui-icon icon-clock"></span>
									    开始时间&nbsp;&nbsp;&nbsp;&nbsp;
									    <span id="startTime">
									      
									    </span>
							</a>
						</li>
						<li class="mui-table-view-cell">
							<a class="mui-navigate-right mytime" data-options='{}'>
								<span class="mui-icon icon-bell"></span>
								结束时间&nbsp;&nbsp;&nbsp;&nbsp;
								<span id="endTime">
									
							    </span>
							</a>
						</li>
						<li class="mui-table-view-cell">
							<a class="mui-navigate-right" id="visitP">
								<span class="mui-icon icon-man"></span>
								参与
								&nbsp;&nbsp;&nbsp;&nbsp;
								<span id="parter">
								</span>
							</a>
						</li>
					</ul>
					<ul class="mui-table-view mui-table-view-group" id="firstUl">
						<li class="mui-table-view-cell">
							<a id="addrTmp">
								<span class="mui-icon icon-location2"></span>
								地点
								&nbsp;&nbsp;&nbsp;&nbsp;
								<span id="addr">
								</span>
								
							</a>
						</li>
					</ul>
				
					<ul class="mui-table-view mui-table-view-group" id="firstUl">
						<li class="mui-table-view-cell">
							<a>
								<span class="mui-icon icon-exit"></span>
								重要<div id="isKey" style="display:none;">1</div>
								<div class="mui-switch mui-switch-blue mui-active" style="float: left;" id="switchBtnId" onClick="changeStatus();">
								<div class="mui-switch-handle"></div>
							</div>
								
							</a>
						</li>
					</ul>
				
				 </form>
				
				</div>
			</div>
		</div>
		
	</body>
	<script>
	mui.plusReady(function(){
			ws=plus.nativeUI.showWaiting();
			var addr = document.getElementById("addr");
			plus.geolocation.getCurrentPosition( function(p){
				ws.close();
				if(!p.addresses){
					mui.alert('定位失败，请检查相关设备!', '提示', function() {
						plus.webview.currentWebview().close();
					});
				}else{
					addr.innerHTML=p.address.province+p.address.district+p.address.street;
					longitude = p.coords.longitude;  
					latitude = p.coords.latitude;  
				}
				
			},function(e){
				ws.close();
				plus.webview.currentWebview().close();
			}
//			,{provider:'baidu'}
			);
		});
	
	
		mui.init({
			swipeBack:true //启用右滑关闭功能
		});
		mui('.mui-scroll-wrapper').scroll();
		var backPage;
		function plusReady(){
			backPage = plus.webview.getWebviewById("calendar_id");
		}

		document.getElementById("senLogId").addEventListener('tap',function(){
			saveScheduleInfo('addShceduleForm');
		});
		
		document.getElementById("visitP").addEventListener('tap',function(){
			selectData();
		});
		document.getElementById("addrTmp").addEventListener('tap',function(){
			selectAddr();
		});
		(function($) {
				$.init();
				var btns = $('.mytime');
				btns.each(function(i, btn) {
					btn.addEventListener('tap', function() {
						var optionsJson = this.getAttribute('data-options') || '{}';
						var options = JSON.parse(optionsJson);
						var s=document.getElementById(this.children[1].id);
						var picker = new $.DtPicker(options);
						picker.show(function(rs) {
							s.innerHTML=rs.text;
							picker.dispose();
						});
					}, false);
				});
			})(mui);
		var dataStr = "";
		var timeStr = "";
		// H5 plus事件处理
		
		if(window.plus){
			plusReady();
		}else{
			document.addEventListener("plusready",plusReady,false);
		}
		
		//添加产品经理介入定自定义事件监听
		window.addEventListener('paramBackEvent__',function(event){
			 var name = event.detail.name;
		     var con = document.getElementById('parter');
		     con.innerText = name;
		})
		
        function selectData(){
        	var currentId = plus.webview.currentWebview().id;
           _App.util.goPage('../../marketing/opport/financialAdviser.html?pageType=SCH_&cwebviewId='+currentId, {refresh:true,pageId:'marketing/financialAdviser.html'});
		}
        
        
        //定位
		function selectAddr(){
			plus.storage.setItem('fieldSignUrl','work/addSchedule.html');
			_App.util.goPage("../register/maps.html");
		};
		//获取定位位置
		window.addEventListener('getDetail',function(event){
			var addr = document.getElementById("addr");
			addr.innerHTML=event.detail.name;
		});
	
	</script>
</html>